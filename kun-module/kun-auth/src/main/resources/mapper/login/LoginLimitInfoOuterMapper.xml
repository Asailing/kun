<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.kun.auth.login.mapper.LoginLimitInfoOuterMapper">
    <!--    分页查询用户登陆限制信息-->
    <select id="selectPage" resultType="cn.kun.auth.login.entity.vo.LoginLimitPageVO">
        SELECT
        a.id,
        a.login_name loginName,
        a.user_outer_ip ip,
        a.start_date startDate,
        a.end_date endDate,
        a.STATUS,
        a.login_type LoginType
        FROM
        login_limit_info_outer a
        <where>
            a.del_flag = 0
            <if test="dto.loginName != null and dto.loginName != ''">
                AND a.login_name LIKE concat( '%', #{dto.loginName}, '%' )
            </if>
            <if test="dto.ip != null and dto.ip != ''">
                AND a.user_outer_ip LIKE concat( '%', #{dto.ip}, '%' )
            </if>
            <if test="dto.startDate != null">
                and a.start_date = #{dto.startDate}
            </if>
            <if test="dto.endDate != null">
                and a.end_date = #{dto.endDate}
            </if>
            <if test="dto.status != null and dto.status != ''">
                AND a.status = #{dto.status}
            </if>
        </where>
        <choose>
            <when test="dto.orderBy != null and dto.orderBy != ''">
                order by ${dto.orderBy}
            </when>
            <otherwise>
                order by a.update_date desc
            </otherwise>
        </choose>
    </select>
</mapper>
